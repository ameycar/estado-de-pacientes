<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estado de Pacientes</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js"></script>
</head>
<body>

    <h1>Estado de Pacientes</h1>

    <h2>Lista de Pacientes</h2>
    <ul id="pacientes"></ul>

    <h3>Agregar Paciente</h3>
    <form id="formularioPaciente">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" required>
        <br>
        <label for="apellido">Apellido:</label>
        <input type="text" id="apellido" required>
        <br>
        <label for="estado">Estado:</label>
        <select id="estado" required>
            <option value="En espera">En espera</option>
            <option value="En atenci贸n">En atenci贸n</option>
            <option value="Atendido">Atendido</option>
            <option value="Programado">Programado</option>
        </select>
        <br>
        <button type="submit">Agregar Paciente</button>
    </form>

    <script>
        // Configuraci贸n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyA1LYlm8HRhW1MPCxsgrQtiFO5rvS0v2_s",
            authDomain: "app-ecografia.firebaseapp.com",
            databaseURL: "https://app-ecografia-default-rtdb.firebaseio.com",
            projectId: "app-ecografia",
            storageBucket: "app-ecografia.firebasestorage.app",
            messagingSenderId: "241799347066",
            appId: "1:241799347066:web:b10b3c963ec9c88f1d34c3",
            measurementId: "G-ZB2XS0DFC8"
        };

        // Inicializar Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database(app);
        const ref = database.ref("pacientes");

        // Mostrar pacientes
        ref.on("value", (snapshot) => {
            const data = snapshot.val();
            const pacientes = data ? Object.values(data) : [];

            // Ordenar pacientes por estado
            pacientes.sort((a, b) => {
                const orden = {
                    "En espera": 1,
                    "En atenci贸n": 2,
                    "Atendido": 3,
                    "Programado": 4
                };
                return orden[a.estado] - orden[b.estado];
            });

            // Mostrar pacientes en la lista
            let listaPacientes = document.getElementById("pacientes");
            listaPacientes.innerHTML = "";

            pacientes.forEach(paciente => {
                const li = document.createElement("li");
                li.textContent = `${paciente.nombre} ${paciente.apellido} - Estado: ${paciente.estado}`;
                listaPacientes.appendChild(li);
            });
        });

        // Agregar nuevo paciente
        document.getElementById("formularioPaciente").addEventListener("submit", function(event) {
            event.preventDefault();

            const nombre = document.getElementById("nombre").value;
            const apellido = document.getElementById("apellido").value;
            const estado = document.getElementById("estado").value;

            const nuevoPaciente = {
                nombre: nombre,
                apellido: apellido,
                estado: estado
            };

            // Guardar en la base de datos
            ref.push(nuevoPaciente).then(() => {
                alert("Paciente agregado");
                // Limpiar formulario
                document.getElementById("formularioPaciente").reset();
            });
        });
    </script>

</body>
</html>
